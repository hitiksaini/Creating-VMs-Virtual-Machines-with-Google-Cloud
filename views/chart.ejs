<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Dashboard page</title>
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <!-- ZingChart CDN script -->
  <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="chart"></div>
  <!-- fetches data from api/data page & renders chart from data returned -->
  <script>
    // creates variable for url we want to fetch
    const url = 'http://localhost:3000/data/college.json';
    // fetch call to our /api/data page
    fetch(url)
      // creates promise to work with response from /api/data
      .then(res => {
        // throws error if there is a problem fetching page
        if (!res.ok) {
          // returns error with response text of error
          throw new Error(res.statusText);
        }
        // returns data from /api/data page in json format to next promise
        return res.json();
      })
      // creates promise with returned data from previous promise
      .then(data => {
        // creates employees variable to store JSON data form /api/data
        let colleges = data;
        // creates empty employeeInfo array
        let collegeInfo = [];
        // loops through data from employee variable
        colleges.forEach(college => {
          // pushes values from employees variable to empty employeeInfo array
          collegeInfo.push([college.name, parseInt(college.num_of_students)]);
        });
        // creates chart const with employeeInfo array
        const chart = {
          type: 'bar',
          series: [{
            values: collegeInfo
          }]
        };
        // renders zingchart to the page
        zingchart.render({
          id: 'chart',
          data: chart,
          height: '100%',
          width: '100%'
        });
      })
      // catches errors in promise chain
      .catch(error => console.log('fetch error'));
  </script>
</body>

</html>
